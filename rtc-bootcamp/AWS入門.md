# AWSで

## region availability zone edge location

regionが一番大きな概念。国に一個とかの単位で存在するデータセンター。

アベイラビリティーゾーンはリージョンの中のさらに小さなデータセンターの単位。

edge locationはCDNサービスを提供するもの。

## 責任共有問題

AWSてきにはハイパーバイザー以下のレイヤーが責任を持つ。
なので、ユーザーはアプリケーションに関するほぼすべてのセキュリティの対応が必要

### セキュリティの確保

ここが主なセキュリティ構築のポイント

- ネットワーク
- 暗号化
- 認証
- コンプライアンス

### AWS security for Service

### セキュリティグループ

インスタンスごとにたいしての以下の**ルールを定義できる。**

- インバウンド
    - プロトコル (TCP/UDP/ICMP)
    - ポート範囲 (ポート番号の範囲)
    - 送信元 (アクセス元のIPアドレス)
- アウトバウンド
    - プロトコル (TCP/UDP/ICMP)
    - ポート範囲 (ポート番号の範囲)
    - 送信元 (アクセス元のIPアドレス)

### Amazon VPC

クラウド内にユーザーのプライベートアドレス空間を構築できるサービス

１リージョン＝１VPCに複数のサブネットを定義できる。１サブネットは１アベイラビリティゾーンに定義できる。

- 1つのVPCは、1つのネットワークアドレス(CIDR)で定義します。
- 1つのVPC内には複数のサブネットを作成することができます。
- サブネットは特定のアベイラビリティゾーン内に配置します。

### ルートテーブル

VPCのルーティングをここで設定できる

VPCのサブネットもここで定義できる。すべての外からのアクセスはルーティングしないって言う設定にすれば良い・

### NACL

**NACLでは、サブネットレベルでのInOutを制御できる**。また、セキュリティグループとの違いはDeny設定ができる。つまり、VPC単位の設定

セキュリティグループは**インスタンス単位**のInOutの制御ができる。

### IAM

認証、認可の仕組み

AWS利用者の認証とアクセスポリシーを管理。

**ユーザーを作成してグループ、ユーザー、ロールで権限管理して開発を行う。**

**ルートアカウントは普通使わんからね。**

MFA（多要素認証）の利用がベター（ワンタイムパスワード）

#### IAMによるユーザーアクティビティの記録

ユーザーログの情報がおえる。合わせてトレイル。

### IAMロール

AWSのサービスなどに対して操作権限を与える仕組み。

このサーバーにはどんな操作ができるのか、などが設定できる。

インスタンス内にアクセスキーをおかなくてすむだったり管理が楽になる。

### S3におけるセキュリティ概念

#### ユーザーポリシ

- どこからアクセス防ぐのか強化するのか
    - IPアドレス指定など


#### バケットポリシー
    - バケットごとにアクセス制限を

## ハンズオン

DBの冗長化とは、ALLアクティブな状態ではない。マスタースレーブ構成ってやつ。

一台死んだら、他方にデータ移してそれを動かすってのがやり方。

- DBに関しては、自動バックアップやスナップショットの管理を自前で
    - やるのは面倒だけど
